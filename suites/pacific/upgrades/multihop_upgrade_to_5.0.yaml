tests:
- test:
    name: install ceph pre-requisites
    module: install_prereq.py
    abort-on-fail: True

- test:
    name: upgrade the RHCS cluster based on the path specified
    polarion-id: ""
    module: test_upgrade.py
    config:
      paths:
        4.2
        4.3
        5.0
        5.1
      suite_setup:
        osd_scenario: lvm
        osd_auto_discovery: False
        copy_admin_key: true
        dashboard_enabled: True
        dashboard_admin_user: admin
        dashboard_admin_password: p@ssw0rd
        grafana_admin_user: admin
        grafana_admin_password: p@ssw0rd
        ceph_conf_overrides:
          global:
            osd_pool_default_pg_num: 64
            osd_default_pool_size: 2
            osd_pool_default_pgp_num: 64
            mon_max_pg_per_osd: 1024
          mon:
            mon_allow_pool_delete: true
          client:
            rgw crypt require ssl: false
            rgw crypt s3 kms encryption keys: testkey-1=YmluCmJvb3N0CmJvb3N0LWJ1aWxkCmNlcGguY29uZgo=
              testkey-2=aWIKTWFrZWZpbGUKbWFuCm91dApzcmMKVGVzdGluZwo=
        cephfs_pools:
          - name: "cephfs_data"
            pgs: "8"
          - name: "cephfs_metadata"
            pgs: "8"
      upgrade:
        steps:
          config:
            command: rolling_update
            upgrade_ceph_packages: True
    desc: deploy ceph setup using ceph-ansible and upgrade to the versions specified in paths
    destroy-cluster: False
    abort-on-fail: true
